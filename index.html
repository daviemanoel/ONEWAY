<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ONE WAY 2025 - Evento Oficial</title>
    <link rel="stylesheet" type="text/css" href="./Css/style.css">
    <link rel="icon" type="image/png" href="./img/2.png">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
</head>

<body>
    <!-- Header com Navega√ß√£o Fixa -->
    <header class="navbar">
        <nav class="nav-container">
            <a href="#" class="logo">ONE WAY 2025</a>
            <ul class="nav-menu">
                <li><a href="#home" class="nav-link">In√≠cio</a></li>
                <li><a href="#minha-secao" class="nav-link">Ingressos</a></li>
                <li><a href="#sobre" class="nav-link">Sobre</a></li>
                <li><a href="#produtos" class="nav-link">Produtos</a></li>
                <li><a href="#faq" class="nav-link">FAQ</a></li>
            </ul>
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </nav>
    </header>

    <section id="home" class="section_home">
        <div style="position: relative; display: inline-block; width:100%">
            <img class="img-desktop" src="./img/One_Way_25-conv.png" alt="ONE WAY 2025 Banner" loading="eager" decoding="async">
            <img class="img-mobile" src="./img/One_Way_25-conv.png" alt="ONE WAY 2025 Mobile Banner" loading="eager" decoding="async">
        </div>
    </section>

    <section id="sobre" class="convidados">
        <div class="convidados__container">
            <div class="convidados__content">
                <h1 class="convidados__title">ONE WAY 2025</h1>
                <div class="convidados__text">
                    <p>Cremos que Deus est√° levantando uma gera√ß√£o que n√£o negocia o Caminho. Jovens apaixonados por Jesus, cheios do Esp√≠rito Santo, que desejam n√£o apenas falar sobre Ele, mas se parecer com Ele ‚Äî em car√°ter, em autoridade e em entrega.</p>
                    <p>O One Way √© mais do que um evento: √© um ajuntamento de filhos que decidiram viver para construir um lugar de habita√ß√£o para a Presen√ßa. Um povo que entende que h√° um √∫nico caminho, e que esse caminho √© suficiente.</p>
                    <p>Queremos, juntos, formar Cristo uns nos outros ‚Äî para que a paix√£o pelo evangelho se transforme em miss√£o, e a miss√£o em frutos que permane√ßam.</p>
                    <p>Porque o mundo n√£o precisa de mais entretenimento. Ele precisa de uma gera√ß√£o que conhe√ßa o Caminho.</p>
                </div>
            </div>
            <div class="convidados__image">
                <img src="./img/fundoteste.jpg" alt="ONE WAY 2025" class="convidados__img" loading="lazy" decoding="async">
            </div>
        </div>

    </section>

    <section id="produtos" class="section_products">
        <div class="products-container" id="products-container">
            <!-- Produtos ser√£o carregados dinamicamente via JavaScript -->
        </div>
    </section>

    <section id="minha-secao" class="section_date_tickets">
        <div class="table-container">
            <table class="date-tickets-table">
                <tr>
                    <td class="date-column">
                        <div class="date-header">
                            <h2>üìÖ Save the Date</h2>
                        </div>
                        <div class="date-info">
                            <div class="event-date">31 DE JULHO √Ä 02 DE AGOSTO</div>
                            <div class="event-year">2025</div>
                            <div class="event-location">
                                <div class="location-name">Mevam Franca</div>
                                <div class="location-city">Rua S√£o Paulo, 1151 - Vila Aparecida, Franca - SP</div>
                            </div>
                        </div>
                    </td>
                    <td class="tickets-column">
                        <div class="tickets-header">
                            <h2>Garanta seu ingresso</h2>
                        </div>
                        <div class="tickets-list">
                            <div class="ticket-item esgotado">
                                <span class="lote-name">Lote 1</span>
                                <span class="status">ESGOTADO</span>
                                <span class="price">---</span>
                            </div>
                            <div class="ticket-item esgotado">
                                <span class="lote-name">Lote 2</span>
                                <span class="status">ESGOTADO</span>
                                <span class="price">---</span>
                            </div>
                            <div class="ticket-item disponivel">
                                <span class="lote-name">Lote 3</span>
                                <span class="status">DISPON√çVEL</span>
                                <span class="price">R$ 170,00</span>
                                <a href="https://tiketo.com.br/evento/3063" target="_blank" class="buy-btn">Comprar</a>
                            </div>
                        </div>
                    </td>
                </tr>
            </table>
        </div>
    </section>

    <section id="faq" class="saq">
        <div class="faq-container">
            <img src="./img/FAQ.png" alt="FAQ" class="faq-logo" loading="lazy" decoding="async">
            <div class="faq-grid">
                <div class="faq-item">
                    <button class="faq-question active">‚ñ∏ Quem pode participar do evento? </button>
                    <div class="faq-answer">Todos os jovens e adolecentes s√£o bem-vindos! O evento √© aberto para quem
                        deseja se
                        conectar com Deus, fazer novas amizades e viver algo especial. Mesmo que voc√™ n√£o fa√ßa parte da
                        nossa igreja, pode participar! </div>
                </div>
                <div class="faq-item">
                    <button class="faq-question">‚ñ∏Qual o hor√°rio de in√≠cio e t√©rmino? </button>
                    <div class="faq-answer">O evento come√ßa pontualmente Quinta e Sexta √†s 19:00 e termina por volta das
                        00:00, e Sabado abrimos 08:00 e termina por volta das 21:00. Recomendamos chegar com pelo menos
                        15 minutos de anteced√™ncia para garantir seu lugar e se organizar com calma.
                    </div>
                </div>
                <div class="faq-item">
                    <button class="faq-question">‚ñ∏ Vai ter alimenta√ß√£o no evento?</button>
                    <div class="faq-answer">Sim! Teremos momentos de intervalo com alimenta√ß√£o dispon√≠vel. A compra da
                        alimenta√ß√£o poder√° ser feita junto com o ingresso, diretamente no site. Importante: n√£o ser√°
                        poss√≠vel adquirir almo√ßo ou jantar durante o evento.</div>
                </div>
                <div class="faq-item">
                    <button class="faq-question">‚ñ∏ Tem limite de idade para participar?</button>
                    <div class="faq-answer">N√£o teremos limita√ß√£o de idades para adolescentes e jovens, incluindo casais
                        casados que ainda n√£o t√™m filhos. Todos s√£o muito bem-vindos!</div>
                </div>
                <div class="faq-item">
                    <button class="faq-question">‚ñ∏Posso levar um amigo que n√£o √© da igreja? </button>
                    <div class="faq-answer">Claro! Voc√™ est√° mais do que convidado a trazer amigos, mesmo que eles n√£o
                        fa√ßam parte da igreja. O evento √© para todos que querem viver algo novo com Deus.
                    </div>
                </div>
                <div class="faq-item">
                    <button class="faq-question">‚ñ∏ Posso sair e voltar durante o evento? </button>
                    <div class="faq-answer">Pedimos que os participantes permane√ßam no local durante todo o evento para
                        garantir seguran√ßa e n√£o perder nenhuma parte da programa√ß√£o. Em casos especiais, fale com a
                        equipe respons√°vel na entrada.</div>
                </div>
                <div class="faq-item">
                    <button class="faq-question">‚ñ∏ Pode tirar fotos e postar nas redes sociais?</button>
                    <div class="faq-answer">Sim! Amamos ver voc√™s registrando e compartilhando os momentos especiais. S√≥
                        pedimos que respeite os outros participantes ao tirar fotos e que marque nosso perfil oficial
                        nas redes sociais! </div>
                </div>
                <div class="faq-item">
                    <button class="faq-question">‚ñ∏ Vai ter algum tipo de roupa espec√≠fica ou dress code? </button>
                    <div class="faq-answer">N√£o temos um dress code obrigat√≥rio, mas recomendamos roupas confort√°veis e
                        modestas, adequadas para momentos de adora√ß√£o, din√¢micas e comunh√£o. Pedimos apenas que todos
                        usem roupas apropriadas para o ambiente, respeitando os demais participantes do evento.
                    </div>
                </div>
                <div class="faq-item">
                    <button class="faq-question">‚ñ∏ Quem eu posso procurar se tiver d√∫vidas no dia do evento? </button>
                    <div class="faq-answer">Durante o evento, teremos uma equipe identificada com crach√°s ou camisetas
                        da organiza√ß√£o que estar√° dispon√≠vel para te ajudar com qualquer d√∫vida. Procure por algu√©m da
                        equipe de recep√ß√£o ou v√° at√© o ponto de apoio na entrada ‚Äî estaremos prontos pra te atender!
                    </div>
                </div>
                <div class="faq-item">
                    <button class="faq-question">‚ñ∏ Preciso levar meu documento ou comprovante de inscri√ß√£o? </button>
                    <div class="faq-answer">Sim, √© importante levar um documento com foto e, se tiver feito inscri√ß√£o
                        online, apresentar o comprovante (impresso ou no celular). Isso ajuda a agilizar sua entrada e
                        garante que tudo ocorra com seguran√ßa¬†e¬†organiza√ß√£o.
                    </div>
                </div>
            </div>
        </div>
    </section>


    <section>
        <div class="div_rodape">
            <img src="./img/rodape.png" alt="" loading="lazy" decoding="async">
        </div>
    </section>

    <script>
        // Menu hamb√∫rguer
        const hamburger = document.querySelector('.hamburger');
        const navMenu = document.querySelector('.nav-menu');
        
        hamburger.addEventListener('click', () => {
            hamburger.classList.toggle('active');
            navMenu.classList.toggle('active');
        });

        // Fechar menu ao clicar em um link
        document.querySelectorAll('.nav-link').forEach(n => n.addEventListener('click', () => {
            hamburger.classList.remove('active');
            navMenu.classList.remove('active');
        }));

        // Navega√ß√£o suave
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // FAQ functionality
        const buttons = document.querySelectorAll('.faq-question');
        buttons.forEach(btn => {
            btn.addEventListener('click', () => {
                buttons.forEach(b => {
                    if (b !== btn) {
                        b.classList.remove('active');
                        b.nextElementSibling.classList.remove('show');
                        b.innerText = b.innerText.replace('‚ñ¥', '‚ñ∏');
                    }
                });

                btn.classList.toggle('active');
                const answer = btn.nextElementSibling;
                answer.classList.toggle('show');
                btn.innerText = btn.classList.contains('active')
                    ? btn.innerText.replace('‚ñ∏', '‚ñ¥')
                    : btn.innerText.replace('‚ñ¥', '‚ñ∏');
            });
        });

        // Fun√ß√£o para comprar camiseta
        function comprarCamiseta() {
            const sizeSelected = document.querySelector('input[name="camiseta-size"]:checked');
            if (sizeSelected) {
                const size = sizeSelected.value;
                window.open('https://buy.stripe.com/dRm4gz0bG2B96sFbtu18c00', '_blank');
            } else {
                alert('Por favor, selecione um tamanho antes de continuar.');
            }
        }

        // Navbar transparente ao rolar
        window.addEventListener('scroll', () => {
            const navbar = document.querySelector('.navbar');
            if (window.scrollY > 100) {
                navbar.classList.add('scrolled');
            } else {
                navbar.classList.remove('scrolled');
            }
        });

        
        // Funcionalidade dos bot√µes de tamanho
        function initSizeButtons() {
            document.querySelectorAll('.size-btn').forEach(button => {
                button.addEventListener('click', function() {
                    // Remove active de todos os bot√µes do mesmo produto
                    const parentSelector = this.closest('.size-selector');
                    parentSelector.querySelectorAll('.size-btn').forEach(btn => btn.classList.remove('active'));
                    // Adiciona active no clicado
                    this.classList.add('active');
                    
                });
            });
            
            // Adicionar evento aos bot√µes de comprar
            document.querySelectorAll('.product-btn').forEach(button => {
                button.addEventListener('click', function() {
                    
                    // Redirecionar para o site de compras
                    window.open('https://tiketo.com.br/evento/3063', '_blank');
                });
            });
        }

        // Carregar produtos do JSON
        async function loadProducts() {
            try {
                const response = await fetch('./products.json');
                const data = await response.json();
                
                // Converter objeto em array e ordenar por ID
                const productsArray = Object.values(data.products).sort((a, b) => parseInt(a.id) - parseInt(b.id));
                
                const container = document.getElementById('products-container');
                container.innerHTML = '';
                
                productsArray.forEach(product => {
                    const hasVideo = product.video && product.video !== '';
                    const hasMultipleImages = product.images && product.images.length > 1;
                    const images = hasMultipleImages ? product.images : [product.image];
                    
                    // Criar array de items incluindo v√≠deo se existir
                    const mediaItems = [...images];
                    if (hasVideo) {
                        mediaItems.push(product.video);
                    }
                    
                    const hasGallery = mediaItems.length > 1;
                    
                    const productHTML = `
                        <div class="product-card" data-product-id="${product.id}">
                            <div class="product-image ${hasGallery ? 'has-gallery' : ''}">
                                ${mediaItems.map((item, index) => {
                                    const isVideo = item.includes('.mp4');
                                    if (isVideo) {
                                        return `<video class="product-video ${index === 0 ? 'active' : ''}" 
                                                       muted loop playsinline preload="metadata" 
                                                       data-media-index="${index}">
                                                    <source src="${item}" type="video/mp4">
                                                </video>`;
                                    } else {
                                        return `<img src="${item}" alt="${product.title}" loading="lazy" decoding="async" 
                                                     class="product-img ${index === 0 ? 'active' : ''}" 
                                                     data-media-index="${index}">`;
                                    }
                                }).join('')}
                                ${hasGallery ? `
                                    <div class="image-dots">
                                        ${mediaItems.map((item, index) => {
                                            const isVideo = item.includes('.mp4');
                                            return `<span class="dot ${index === 0 ? 'active' : ''}" 
                                                          data-media-index="${index}" 
                                                          data-is-video="${isVideo}">
                                                        ${isVideo ? '‚ñ∂' : ''}
                                                    </span>`;
                                        }).join('')}
                                    </div>
                                ` : ''}
                            </div>
                            <div class="product-info">
                                <h3>${product.title}</h3>
                                <div class="product-price">R$ ${product.price.toFixed(2).replace('.', ',')}</div>
                                <div class="size-selector">
                                    <div class="size-options">
                                        ${Object.entries(product.sizes).map(([size, sizeData]) => {
                                            const isAvailable = sizeData.available;
                                            const isActive = size === 'M' && isAvailable;
                                            const disabled = !isAvailable ? 'disabled' : '';
                                            const activeClass = isActive ? 'active' : '';
                                            return `<button class="size-btn ${activeClass}" data-size="${size}" data-stripe-id="${sizeData.id_stripe}" ${disabled}>${size}</button>`;
                                        }).join('')}
                                    </div>
                                </div>
                                <div class="payment-selector">
                                    <label>Forma de pagamento:</label>
                                    <select class="payment-method">
                                        <option value="1x">√Ä vista</option>
                                        <option value="2x">2x sem juros</option>
                                        <option value="3x">3x</option>
                                        <option value="4x">4x</option>
                                    </select>
                                </div>
                                <button class="product-btn" data-product-id="${product.id}">Comprar Agora</button>
                            </div>
                        </div>
                    `;
                    container.innerHTML += productHTML;
                });
                
                // Reinicializar funcionalidades ap√≥s carregar produtos
                initSizeButtons();
                initImageGallery();
                
            } catch (error) {
                console.error('Erro ao carregar produtos:', error);
                // Fallback: mostrar mensagem de erro
                document.getElementById('products-container').innerHTML = '<p>Erro ao carregar produtos. Tente novamente.</p>';
            }
        }

        // Funcionalidade dos bot√µes de tamanho (atualizada)
        function initSizeButtons() {
            document.querySelectorAll('.size-btn').forEach(button => {
                button.addEventListener('click', function() {
                    if (this.disabled) return;
                    
                    // Remove active de todos os bot√µes do mesmo produto
                    const parentSelector = this.closest('.size-selector');
                    parentSelector.querySelectorAll('.size-btn').forEach(btn => btn.classList.remove('active'));
                    // Adiciona active no clicado
                    this.classList.add('active');
                    
                });
            });
            
            // Adicionar evento aos bot√µes de comprar (dual payment)
            document.querySelectorAll('.product-btn').forEach(button => {
                button.addEventListener('click', async function() {
                    
                    // Pegar tamanho selecionado
                    const productCard = this.closest('.product-card');
                    const selectedSizeBtn = productCard.querySelector('.size-btn.active');
                    const productId = this.dataset.productId;
                    const paymentMethod = productCard.querySelector('.payment-method').value;
                    
                    if (!selectedSizeBtn) {
                        alert('Por favor, selecione um tamanho dispon√≠vel.');
                        return;
                    }
                    
                    const size = selectedSizeBtn.dataset.size;
                    const priceId = selectedSizeBtn.dataset.stripeId;
                    const productName = productCard.querySelector('h3').textContent;
                    
                    if (!priceId || priceId === 'null') {
                        alert('Tamanho indispon√≠vel para compra.');
                        return;
                    }
                    
                    // Desabilitar bot√£o durante processamento
                    this.disabled = true;
                    this.textContent = 'Processando...';
                    
                    try {
                        let response;
                        
                        if (paymentMethod === '1x') {
                            // 1x = Stripe (cart√£o internacional)
                            response = await fetch('/create-checkout-session', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                },
                                body: JSON.stringify({
                                    priceId: priceId,
                                    productName: productName,
                                    size: size
                                })
                            });
                        } else {
                            // 2x ou mais = Mercado Pago
                            response = await fetch('/create-mp-checkout', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                },
                                body: JSON.stringify({
                                    priceId: priceId,
                                    productName: productName,
                                    size: size,
                                    installments: parseInt(paymentMethod)
                                })
                            });
                        }
                        
                        const data = await response.json();
                        
                        if (data.url || data.checkout_url) {
                            // Redirecionar para o checkout
                            window.location.href = data.url || data.checkout_url;
                        } else {
                            throw new Error(data.error || 'Erro ao processar pagamento');
                        }
                    } catch (error) {
                        console.error('Erro no checkout:', error);
                        alert('Erro ao processar pagamento. Tente novamente.');
                    } finally {
                        // Restaurar bot√£o
                        this.disabled = false;
                        this.textContent = 'Comprar Agora';
                    }
                });
            });
        }


        // Fun√ß√£o para controlar galeria unificada (imagens + v√≠deo)
        function initImageGallery() {
            document.querySelectorAll('.product-image.has-gallery').forEach(container => {
                const dots = container.querySelectorAll('.dot');
                const images = container.querySelectorAll('.product-img');
                const videos = container.querySelectorAll('.product-video');
                const allMedia = container.querySelectorAll('[data-media-index]');
                
                dots.forEach(dot => {
                    dot.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const mediaIndex = parseInt(dot.dataset.mediaIndex);
                        const isVideo = dot.dataset.isVideo === 'true';
                        
                        // Remove active de todos
                        dots.forEach(d => d.classList.remove('active'));
                        allMedia.forEach(media => {
                            media.classList.remove('active');
                            // Parar v√≠deos que n√£o est√£o ativos
                            if (media.tagName === 'VIDEO') {
                                media.pause();
                                media.currentTime = 0;
                            }
                        });
                        
                        // Adiciona active no selecionado
                        dot.classList.add('active');
                        allMedia[mediaIndex].classList.add('active');
                        
                        // Se for v√≠deo, reproduzir
                        if (isVideo && allMedia[mediaIndex].tagName === 'VIDEO') {
                            allMedia[mediaIndex].play().catch(e => console.log('Video play failed:', e));
                        }
                    });
                });
            });
        }

        // Inicializar quando p√°gina carregar
        document.addEventListener('DOMContentLoaded', () => {
            loadProducts();
        });

    </script>

</body>

</html>